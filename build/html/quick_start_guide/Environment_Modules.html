
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Introduction and Basic Use &#8212; DEAC Cluster Wiki  documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <p>The modules[1] package allows you to modify your environment to use
specific versions of software you may need. More importantly, it allows
you to easily undo those modifications if you need to use a different
package or version.</p>
<div class="section" id="introduction-and-basic-use">
<h1>Introduction and Basic Use<a class="headerlink" href="#introduction-and-basic-use" title="Permalink to this headline">¶</a></h1>
<p>Let’s say you need to do compilations with Intel Cluster Studio 2012
with 4-byte integers. You would set up your environment (paths, library
paths, etc) by doing:</p>
<p><code class="docutils literal notranslate">&#160;&#160; <span class="pre">$</span> <span class="pre">module</span> <span class="pre">load</span> <span class="pre">compilers/intel-2012-lp64</span></code></p>
<p>You would use this in <a class="reference external" href="Software:SLURM">SLURM</a> scripts, too,
because the resulting executable may need to know the paths to the
dynamic libraries to which it is linked. If you no longer need to use
that particular compiler, you would do:</p>
<p><code class="docutils literal notranslate">&#160;&#160; <span class="pre">$</span> <span class="pre">module</span> <span class="pre">unload</span> <span class="pre">compilers/intel-2012-lp64</span></code></p>
<p>To switch to a different compiler, you would unload and then load the
environment for the new compiler:</p>
<p><code class="docutils literal notranslate">&#160;&#160; <span class="pre">$</span> <span class="pre">module</span> <span class="pre">unload</span> <span class="pre">compilers/intel-2012-lp64</span></code>
<code class="docutils literal notranslate">&#160;&#160; <span class="pre">$</span> <span class="pre">module</span> <span class="pre">load</span> <span class="pre">compilers/pgi-XXX</span></code></p>
<p>You can see modules you have
loaded:</p>
<p><code class="docutils literal notranslate">&#160;&#160; <span class="pre">$</span> <span class="pre">module</span> <span class="pre">list</span></code>
<code class="docutils literal notranslate">&#160;&#160; </code>
<code class="docutils literal notranslate">&#160;&#160; <span class="pre">Currently</span> <span class="pre">Loaded</span> <span class="pre">Modulefiles:</span></code>
<code class="docutils literal notranslate">&#160;&#160;&#160;&#160; <span class="pre">1)</span> <span class="pre">dot</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">2)</span> <span class="pre">use.own</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">3)</span> <span class="pre">compilers/intel-2012-ilp64</span></code></p>
<p>You can see all available modules that may be
loaded:</p>
<p><code class="docutils literal notranslate">&#160;&#160; <span class="pre">$</span> <span class="pre">module</span> <span class="pre">avail</span></code>
<code class="docutils literal notranslate">&#160;&#160; </code>
<code class="docutils literal notranslate">&#160;&#160; <span class="pre">--------------------------------------</span> <span class="pre">/usr/share/Modules/modulefiles</span> <span class="pre">---------------------------------------</span></code>
<code class="docutils literal notranslate">&#160;&#160; <span class="pre">dot</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">module-cvs</span>&#160;&#160;&#160; <span class="pre">module-info</span>&#160;&#160; <span class="pre">modules</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">mpich2-x86_64</span> <span class="pre">null</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">use.own</span></code>
<code class="docutils literal notranslate">&#160;&#160; </code>
<code class="docutils literal notranslate">&#160;&#160; <span class="pre">---------------------------------------------</span> <span class="pre">/etc/modulefiles</span> <span class="pre">----------------------------------------------</span></code>
<code class="docutils literal notranslate">&#160;&#160; <span class="pre">mvapich-psm-x86_64</span> <span class="pre">mvapich-x86_64</span>&#160;&#160;&#160;&#160; <span class="pre">mvapich2-x86_64</span></code>
<code class="docutils literal notranslate">&#160;&#160; </code>
<code class="docutils literal notranslate">&#160;&#160; <span class="pre">----------------------------------------</span> <span class="pre">/home/username/privatemodules</span> <span class="pre">----------------------------------------</span></code>
<code class="docutils literal notranslate">&#160;&#160; <span class="pre">compilers/foobar-0.1</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">compilers/intel-2012-ilp64</span> <span class="pre">compilers/intel-2012-lp64</span>&#160; <span class="pre">null</span></code></p>
<p>You can get brief information about a
module:</p>
<p><code class="docutils literal notranslate">&#160;&#160; <span class="pre">$</span>&#160; <span class="pre">module</span> <span class="pre">whatis</span> <span class="pre">compilers/intel-2012-ilp64</span></code>
<code class="docutils literal notranslate">&#160;&#160; <span class="pre">compilers/intel-2012-ilp64:</span> <span class="pre">Sets</span> <span class="pre">up</span> <span class="pre">to</span> <span class="pre">use</span> <span class="pre">the</span> <span class="pre">Intel</span> <span class="pre">Cluster</span> <span class="pre">Studio</span> <span class="pre">2012</span> <span class="pre">compilation</span> <span class="pre">environment</span> <span class="pre">with</span> <span class="pre">8-byte</span> <span class="pre">integers.</span></code></p>
<p>And longer
information:</p>
<p><code class="docutils literal notranslate">&#160;&#160; <span class="pre">$</span> <span class="pre">module</span> <span class="pre">help</span> <span class="pre">compilers/intel-2012-ilp64</span></code>
<code class="docutils literal notranslate">&#160;&#160; </code>
<code class="docutils literal notranslate">&#160;&#160; <span class="pre">-----------</span> <span class="pre">Module</span> <span class="pre">Specific</span> <span class="pre">Help</span> <span class="pre">for</span> <span class="pre">'compilers/intel-2012-ilp64'</span> <span class="pre">---------------------------</span></code>
<code class="docutils literal notranslate">&#160;&#160; </code>
<code class="docutils literal notranslate">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Sets</span> <span class="pre">up</span> <span class="pre">to</span> <span class="pre">use</span> <span class="pre">Intel</span> <span class="pre">Cluster</span> <span class="pre">Studio</span> <span class="pre">XE/Composer</span> <span class="pre">XE</span> <span class="pre">compilers</span> <span class="pre">and</span> <span class="pre">tools</span> <span class="pre">-</span> <span class="pre">8-byte</span> <span class="pre">integers</span></code>
<code class="docutils literal notranslate">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Includes:</span> <span class="pre">C/C++</span> <span class="pre">12.1.0,</span> <span class="pre">Fortran</span> <span class="pre">12.1.0,</span> <span class="pre">Debugger</span> <span class="pre">12.1,</span></code>
<code class="docutils literal notranslate">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Inspector</span> <span class="pre">XE</span> <span class="pre">12.0,</span> <span class="pre">Trace</span> <span class="pre">Analyzer,</span> <span class="pre">VTune</span> <span class="pre">Amplifier,</span></code>
<code class="docutils literal notranslate">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Intel</span> <span class="pre">MPI/OpenMP</span> <span class="pre">4.0.3,</span> <span class="pre">MPI</span> <span class="pre">Benchmarks</span> <span class="pre">3.2.3,</span></code>
<code class="docutils literal notranslate">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Intel</span> <span class="pre">Performance</span> <span class="pre">Primitives,</span> <span class="pre">Thread</span> <span class="pre">Building</span> <span class="pre">Blocks,</span></code>
<code class="docutils literal notranslate">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Math</span> <span class="pre">Kernel</span> <span class="pre">Library,</span> <span class="pre">Cilk</span></code>
<code class="docutils literal notranslate">&#160;&#160; </code>
<code class="docutils literal notranslate">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Version</span> <span class="pre">2012</span></code></p>
</div>
<div class="section" id="use-in-shell-scripts-and-slurm-job-scripts">
<h1>Use in Shell Scripts and <a class="reference external" href="Software:SLURM">SLURM</a> Job Scripts<a class="headerlink" href="#use-in-shell-scripts-and-slurm-job-scripts" title="Permalink to this headline">¶</a></h1>
<p>Incorporating the module command into shell scripts will depend on the
shell that you use: bash or tcsh.</p>
<div class="section" id="bash-sh-ksh">
<h2>bash/sh/ksh<a class="headerlink" href="#bash-sh-ksh" title="Permalink to this headline">¶</a></h2>
<p>Bash scripts, by default, do not execute system-wide login scripts (i.e.
the scripts in /etc/profile.d). Since the “module” command is provided
by one of the login scripts in /etc/profile.d, that means doing “module
load somemodule” in your script will fail, in general. There are two
ways to fix this:</p>
<ol class="simple">
<li><p>Run bash as a login shell: in the first line of your script, do
“<strong><code class="docutils literal notranslate"><span class="pre">#!/bin/bash``</span> <span class="pre">``-l</span></code></strong>”</p></li>
<li><p>Manually execute the modules login script: in the early part of your
script, do “<strong><code class="docutils literal notranslate"><span class="pre">.``</span> <span class="pre">``/etc/profile.d/modules.sh</span></code></strong>”</p></li>
</ol>
</div>
<div class="section" id="tcsh-csh">
<h2>tcsh/csh<a class="headerlink" href="#tcsh-csh" title="Permalink to this headline">¶</a></h2>
<p>Tcsh scripts, by default, <em>do</em> execute system-wide login scripts, so the
“module” command should be available.</p>
<p>However, if you generally use “<strong><code class="docutils literal notranslate"><span class="pre">#!/bin/tcsh``</span> <span class="pre">``-f</span></code></strong>”, you will have
to add “<strong><code class="docutils literal notranslate"><span class="pre">source``</span> <span class="pre">``/etc/profile.d/modules.csh</span></code></strong>” to the early part
of your script. This is because the “-f” option to tcsh says not to
source any login scripts or perform command hashing for faster startup.
This speed difference is not really noticeable on modern systems.</p>
</div>
</div>
<div class="section" id="modulefiles">
<h1>Modulefiles<a class="headerlink" href="#modulefiles" title="Permalink to this headline">¶</a></h1>
<p>Systemwide modulefiles are located in: /usr/share/Modules/modulefiles
and /etc/modulefiles. Each user may write their own module files, and
put them in ~/privatemodules. There may be subdirectories in the module
directories. Subdirectory names will be part of the module name, e.g.
the module file ~/privatemodules/compilers/intel-2012-ilp64 provides the
module named “compilers/intel-2012-ilp64”.</p>
<p>More information is available in the man page for modulefile.[2]</p>
<p>Before you will be able to use your own module files, you must load a
module that allows you to use your own modules:</p>
<p><code class="docutils literal notranslate">&#160;&#160; <span class="pre">$</span> <span class="pre">module</span> <span class="pre">load</span> <span class="pre">use.own</span></code></p>
<div class="section" id="things-to-note">
<h2>Things to Note<a class="headerlink" href="#things-to-note" title="Permalink to this headline">¶</a></h2>
<p>Modulefiles are in an extended version of the Tcl scripting language.
One important thing to note is that environment variables that are used
in one part of the script may not be used in another because the
environment variable is not yet set in the environment:</p>
<p><code class="docutils literal notranslate">&#160; <span class="pre">#</span></code><strong><code class="docutils literal notranslate"><span class="pre">THIS``</span> <span class="pre">``WILL``</span> <span class="pre">``NOT``</span> <span class="pre">``WORK</span></code></strong>
<code class="docutils literal notranslate">&#160;&#160; <span class="pre">setenv</span> <span class="pre">FOOBAR</span> <span class="pre">&quot;/foobar&quot;</span></code>
<code class="docutils literal notranslate">&#160;&#160; <span class="pre">setenv</span> <span class="pre">FOOBAR_BIN</span> <span class="pre">&quot;$FOOBAR/bin&quot;</span></code></p>
<p>You will need to use variables defined in the Tcl script:</p>
<p><code class="docutils literal notranslate">&#160;&#160; <span class="pre">#</span> <span class="pre">Set</span> <span class="pre">a</span> <span class="pre">variable</span> <span class="pre">in</span> <span class="pre">Tcl</span></code>
<code class="docutils literal notranslate">&#160;&#160; <span class="pre">set</span> <span class="pre">foobar</span> <span class="pre">&quot;/foobar&quot;</span></code>
<code class="docutils literal notranslate">&#160;&#160; <span class="pre">setenv</span> <span class="pre">FOOBAR</span> <span class="pre">&quot;$foobar&quot;</span></code>
<code class="docutils literal notranslate">&#160;&#160; <span class="pre">setenv</span> <span class="pre">FOOBAR_BIN</span> <span class="pre">&quot;$foobar/bin&quot;</span></code></p>
<p>Other things to note:</p>
<ul class="simple">
<li><p>TCL considers “_” (underscore) as part of a variable name, but not
“-“ (hyphen).</p>
<ul>
<li><p>So, <code class="docutils literal notranslate"><span class="pre">$foo_bar</span></code>, <code class="docutils literal notranslate"><span class="pre">${foo_bar}</span></code> are equivalent: they are the same
variable <strong>foo_bar</strong></p></li>
<li><p>And, <code class="docutils literal notranslate"><span class="pre">$foo-bar</span></code> and <code class="docutils literal notranslate"><span class="pre">${foo}-bar</span></code> are equivalent: that is the
variable <strong>foo</strong> appended by the string “-bar”</p></li>
</ul>
</li>
<li><p>If you want to use “_” as a separator, you will have to either
group the variable name in a pair of braces {}, or escape the
underscore with a backslash:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">${foo}_bar</span></code> – this is <strong>foo</strong> appended with “_bar”</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">$foo_bar</span></code> – this is also <strong>foo</strong> appended with “_bar”</p></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="known-bugs">
<h1>Known Bugs<a class="headerlink" href="#known-bugs" title="Permalink to this headline">¶</a></h1>
<p>Sometimes, the module command will crash when doing a “module unload”.
It will print out a long error message. If this happens, do “cd” to go
back to your home directory, and repeat the “module unload” command. If
that still does not work, you will have to log out and back in.</p>
</div>
<div class="section" id="troubleshooting">
<h1>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permalink to this headline">¶</a></h1>
<div class="section" id="command-not-found">
<h2>Command Not Found<a class="headerlink" href="#command-not-found" title="Permalink to this headline">¶</a></h2>
<p>; Login Shell : /bin/bash</p>
<p>; Error Message in Job Script : <strong>module: command not found</strong></p>
</pre><ul class="simple">
<li><p>Note: all other subsequent error messages in your job output can
most likely be ignored in troubleshooting this problem as they are
most likely a result of the missing environment setup the module
command would have provided.</p></li>
</ul>
<div class="section" id="solution">
<h3>Solution<a class="headerlink" href="#solution" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>As a BASH shell user, the ‘module’ system does not load modules
automatically. To allow for environment modules to be used in your
batch script, add the following line to your (after the #SBATCH
directives):</p></li>
</ul>
<!-- end list --><ul class="simple">
<li></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="o">.</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">profile</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">modules</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="example">
<h1>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h1>
<p>Here is an example modulefile for Mathematica
8.0.4:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#%Module########################################################################
##
## mathematica-8.0.4 modulefile
##

# for Tcl script use only
set     version        8.0.4
set     mathematicadir /deac/opt/mathematica-$version/bin

proc ModulesHelp { } {
    global version

    puts stderr &quot;    This module sets up the environment to use Mathematica $version&quot;
    puts stderr &quot;    To run remotely, you may need to install the Mathematica fonts:&quot;
    puts stderr &quot;    http://support.wolfram.com/technotes/latestfonts.en.html&quot;
}

module-whatis   &quot;Sets up the environment to use Mathematica $version&quot;

prepend-path PATH $mathematicadir
</pre></div>
</div>
</div>
<div class="section" id="references">
<h1>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h1>
<references/><p><a class="reference external" href="Category:Quick_Start">Category:Quick Start</a></p>
<ol class="simple">
<li><p><a class="reference external" href="http://modules.sourceforge.net/">Modules – Software Environment Management: project page at
Sourceforge</a></p></li>
<li><p><a class="reference external" href="http://modules.sourceforge.net/man/modulefile.html">modulefile man
page</a></p></li>
</ol>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">DEAC Cluster Wiki</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Adam Carlson, Cody Stevens, Sean Anderson.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.2.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/quick_start_guide/Environment_Modules.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>