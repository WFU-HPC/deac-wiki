
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Overview &#8212; DEAC Cluster Wiki  documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <p>Once you have <a class="reference external" href="Software:Text_Editors">written your code</a>, how
do you run it? This article will give an overview of every compiler
available. For more details, please see the dedicated article for each
compiler.</p>
<div class="section" id="overview">
<h1>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h1>
<p>Once you have picked a language, you pick one of several compilers for
that language. Regardless of compiler, you will probably have to specify
the following (there are defaults, but they may not do what you need):</p>
<ol class="simple">
<li><p>optimization and other compilation option flags (static? threaded?
strict IEEE arithmetic? Intel SSE extensions?)</p></li>
<li><p>links to libraries - this varies greatly</p></li>
<li><p>parallel computing - which version of MPI?</p></li>
<li><p>other environment variables - these may have to be set when the
program is to be run, as well</p></li>
</ol>
<p>A brief example – compile a program consisting of a single source
file:</p>
<p><code class="docutils literal notranslate">&#160;&#160;&#160; <span class="pre">$</span> <span class="pre">which</span> <span class="pre">icc</span></code>
<code class="docutils literal notranslate">&#160;&#160;&#160; <span class="pre">icc:</span> <span class="pre">Command</span> <span class="pre">not</span> <span class="pre">found.</span></code>
<code class="docutils literal notranslate">&#160;&#160;&#160; <span class="pre">$</span> <span class="pre">module</span> <span class="pre">load</span> <span class="pre">compilers/intel-2012-lp64</span></code>
<code class="docutils literal notranslate">&#160;&#160;&#160; <span class="pre">$</span> <span class="pre">which</span> <span class="pre">icc</span></code>
<code class="docutils literal notranslate">&#160;&#160;&#160; <span class="pre">/deac/opt/intel/ics2012/composer_xe_2011_sp1.6.233/bin/intel64/icc</span></code>
<code class="docutils literal notranslate">&#160;&#160; <span class="pre">$</span> <span class="pre">icc</span> <span class="pre">-O3</span> <span class="pre">-ipo</span> <span class="pre">hello.c</span> <span class="pre">-o</span> <span class="pre">hello</span></code>
<code class="docutils literal notranslate">&#160;&#160;&#160; <span class="pre">ipo:</span> <span class="pre">remark</span> <span class="pre">#11001:</span> <span class="pre">performing</span> <span class="pre">single-file</span> <span class="pre">optimizations</span></code>
<code class="docutils literal notranslate">&#160;&#160;&#160; <span class="pre">ipo:</span> <span class="pre">remark</span> <span class="pre">#11006:</span> <span class="pre">generating</span> <span class="pre">object</span> <span class="pre">file</span> <span class="pre">/tmp/ipo_iccl60kWX.o</span></code>
<code class="docutils literal notranslate">&#160;&#160; <span class="pre">./hello</span></code>
<code class="docutils literal notranslate">&#160;&#160;&#160; <span class="pre">hello,</span> <span class="pre">world</span></code></p>
<p>Here, we assume you understand common compilation options and flags:
<code class="docutils literal notranslate"><span class="pre">-I,</span> <span class="pre">-L,</span> <span class="pre">-l</span></code>.</p>
<div class="section" id="third-party-code">
<h2>Third-party Code<a class="headerlink" href="#third-party-code" title="Permalink to this headline">¶</a></h2>
<p>In general, compiling scientific software downloaded as source from
elsewhere is a complex task. No two packages are set up the same way, de
facto standards for structuring the build process are almost never
followed, and optimization options vary so much with hardware that the
softare authors’ settings may not be applicable. In addition,
non-standard language features may be used. If you have some software
that needs to be compiled, please contact
<a class="reference external" href="mailto:deac-help&#37;&#52;&#48;wfu">deac-help<span>&#64;</span>wfu<span>&#46;</span>edu</a> for assistance.</p>
</div>
</div>
<div class="section" id="defaults">
<h1>Defaults<a class="headerlink" href="#defaults" title="Permalink to this headline">¶</a></h1>
<p>By default, every user’s environment is ready to use the GNU Compiler
Collection (GCC 4.4.6). Languages supported are:</p>
<ul class="simple">
<li><p>C - gcc</p></li>
<li><p>C++ - g++</p></li>
<li><p>Fortran 90/95 - gfortran</p></li>
</ul>
</div>
<div class="section" id="available-compilers">
<h1>Available Compilers<a class="headerlink" href="#available-compilers" title="Permalink to this headline">¶</a></h1>
<p>These are the available compiler suites, listed by vendor – links lead
to more detailed articles about using each compiler suite:</p>
<ul class="simple">
<li><p>GNU Compiler Collection 4.4.6</p></li>
<li><p><a class="reference external" href="Compiler:Intel_Cluster_Studio">Intel Cluster Studio XE
2012</a></p></li>
<li><p><a class="reference external" href="Compiler:PGI_Cluster_Development_Kit">Portland Group, Inc.
12.1</a></p></li>
</ul>
<div class="section" id="selecting-a-compiler-suite">
<h2>Selecting A Compiler Suite<a class="headerlink" href="#selecting-a-compiler-suite" title="Permalink to this headline">¶</a></h2>
<p>There is a way to manage all the environment variable settings that are
needed, including unsetting them when you are done.[1] This is via the
<strong>modules</strong> system. It provides a new command
<a class="reference external" href="Quick_Start_Guide:Environment_Modules"><code class="docutils literal notranslate"><span class="pre">module</span></code></a> which loads
the appropriate environment.</p>
<p>These are the modules available for third-party compilers:</p>
<ul class="simple">
<li><p>compilers/intel-2012-lp64 – Intel Cluster Studio 2012 with 32-bit
ints. N.B. this is the version you should usually use</p></li>
<li><p>compilers/intel-2012-ilp64 – Intel Cluster Studio 2012 with 64-bit
ints.</p></li>
<li><p>compilers/pgi-12.1 – Portland Group</p></li>
<li><p>compilers/pgi-12.1-mpi – Portland Group with MPI</p></li>
<li><p>compilers/pgi-12.1-mpi2 – Portland Group with MPI2</p></li>
<li><p>compilers/pgi-12.1-mvapich – Portland Group with MVAPICH, allowing
use of InfiniBand</p></li>
</ul>
<p>To use one of these compiler suites, type the following commandline:</p>
<p><code class="docutils literal notranslate">&#160;&#160; <span class="pre">$</span></code><a class="reference external" href="Quick_Start_Guide:Environment_Modules"><code class="docutils literal notranslate"><span class="pre">module``</span> <span class="pre">``load``</span> </code><em><code class="docutils literal notranslate"><span class="pre">modulename</span></code></em></a></p>
<p>E.g. to use Intel 2012 with 32-bit integers, <code class="docutils literal notranslate"><span class="pre">module</span> <span class="pre">load</span> <span class="pre">compilers/intel-2012-lp64</span></code></p>
</div>
<div class="section" id="selecting-a-parallel-computing-library">
<h2>Selecting a Parallel Computing Library<a class="headerlink" href="#selecting-a-parallel-computing-library" title="Permalink to this headline">¶</a></h2>
<p>RHEL6 comes with several MPI implementations. When compiling with GCC,
we recommend OpenMPI, which supports both Ethernet and Infiniband. To
use OpenMPI, load the appropriate module:</p>
<p><code class="docutils literal notranslate">&#160;&#160;&#160; <span class="pre">module</span> <span class="pre">load</span> <span class="pre">openmpi/1.6-gnu</span></code></p>
<p><strong>NOTE:</strong> This is a change as of May 22, 2012. We have had issues
getting the default openmpi from RedHat to work. So, we have built the
latest version from source. Do not use the openmpi-x86_64 module,
anymore. Also available is openmpi/1.5.5-gnu.</p>
<p>Note, however, that this does not set the CC or FC or F90 environment
variables. When compiling an MPI program, you should use the MPI-enabled
compilers: mpicc, mpif90. You may have to set the CC or F90 environment
variables to <code class="docutils literal notranslate"><span class="pre">mpicc</span></code> and <code class="docutils literal notranslate"><span class="pre">mpif90</span></code> manually. You may also have to do this
when compiling 3rd party software. OpenMPI should select the best
available network fabric at run time.</p>
<p>The Intel Cluster Studio comes with Intel’s implementation of MPI, which
supports both Ethernet and <a class="reference external" href="Infiniband">Infiniband</a>. Loading
the appropriate compiler suite module also sets up environment variables
for using Intel’s MPI. However, you may still need to specify CC=mpicc
or F90=mpifort when compiling 3rd party software.</p>
<p>At this point in time (May 23, 2012), we recommend that you use Open
MPI. We have installed the latest version of Open MPI (1.6) compiled
with the installed version of Intel Cluster Studio. To use it, load the
appropriate module file:</p>
<p><code class="docutils literal notranslate">&#160;&#160;&#160; <span class="pre">module</span> <span class="pre">load</span> <span class="pre">openmpi/1.6-intel</span></code></p>
<p>The Portland Group compiler suite comes with three different versions of
MPI. The cluster support staff have little experience with Portland
compilers, so please edit this article.</p>
</div>
</div>
<div class="section" id="recommendations">
<h1>Recommendations<a class="headerlink" href="#recommendations" title="Permalink to this headline">¶</a></h1>
<p>We recommend the <a class="reference external" href="Compiler:Intel_Cluster_Studio">Compiler:Intel Cluster
Studio</a> with the Math Kernel
Library (MKL).</p>
<p>Additionally:</p>
<ul class="simple">
<li><p>For serial multi-threaded code, use openmp (this has nothing to do
with OpenMPI)</p></li>
<li><p>For parallel code, you <strong>must</strong> use <a class="reference external" href="Quick_Start_Guide:GNU_OpenMPI">Quick Start Guide:GNU
OpenMPI</a>. The MPI
implementation bundled with the Intel Compiler Suite does not work
in our environment.</p></li>
</ul>
<p>Complication: Using the MKL means using an arcane set of compiler
options. You <strong>must</strong> use the <a class="reference external" href="http://software.intel.com/en-us/articles/intel-mkl-link-line-advisor">MKL Link Line
Advisor</a>
to generate an appropriate set of compilation options. Please see the
<a class="reference external" href="Compiler:Intel_Cluster_Studio">Compiler:Intel Cluster
Studio</a> article for details on
what version of MKL to pick, etc.</p>
<div class="section" id="serial">
<h2>Serial<a class="headerlink" href="#serial" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>Clean your environment (<strong>important</strong>): module purge</p></li>
<li><p>Load the Intel compiler module: <code class="docutils literal notranslate"><span class="pre">module</span> <span class="pre">load</span> <span class="pre">compilers/intel-2012-lp64</span></code></p></li>
</ol>
</div>
<div class="section" id="single-node-multithreaded">
<h2>Single-node multithreaded<a class="headerlink" href="#single-node-multithreaded" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>Use the <strong>openmp</strong> option when generating link line at the Link Line
Advisor</p></li>
</ol>
</div>
<div class="section" id="parallel">
<h2>Parallel<a class="headerlink" href="#parallel" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>Clean your environment (<strong>important</strong>): module purge</p></li>
<li><p>Load the OpenMPI module, which automatically loads the appropriate
Intel Compiler module that it depends on: <code class="docutils literal notranslate"><span class="pre">module</span> <span class="pre">load</span> <span class="pre">openmpi/1.6-intel</span></code></p></li>
<li><p>DO NOT use openmp: our experience has shown that mixing MPI with
openmp often results in programs which crash</p></li>
</ol>
</div>
</div>
<div class="section" id="example">
<h1>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h1>
<p>Assume you have a single source file that uses FFTW3. The following may
be an example of a compilation
invocation:</p>
<p><code class="docutils literal notranslate">&#160;&#160; <span class="pre">$</span> <span class="pre">module</span> <span class="pre">load</span> <span class="pre">libs/fftw-3.3.1/gnu</span></code>
<code class="docutils literal notranslate">&#160;&#160; <span class="pre">$</span> <span class="pre">env</span> <span class="pre">|</span> <span class="pre">grep</span> <span class="pre">FFTW</span></code>
<code class="docutils literal notranslate">&#160;&#160; <span class="pre">FFTW3DIR=/deac/opt/gnu-libs/fftw-3.3.1</span></code>
<code class="docutils literal notranslate">&#160;&#160; <span class="pre">$</span> <span class="pre">gcc</span> <span class="pre">-O3</span> <span class="pre">-pthread</span> <span class="pre">-I${FFTW3DIR}/include</span> <span class="pre">mycode.c</span> <span class="pre">-L${FFTW3DIR}/lib</span> <span class="pre">-lfftw3_threads</span> <span class="pre">-lm</span></code></p>
</div>
<div class="section" id="makefiles">
<h1>Makefiles<a class="headerlink" href="#makefiles" title="Permalink to this headline">¶</a></h1>
<p>Compiling by manually typing in compile commands is inefficient. The
long commandline required for linking and including dependencies also
makes it prone to errors. Writing aliases or shell scripts to do this is
also not a good way to go.</p>
<p>The most maintainable way of managing the builds of your code is by
using Makefiles.[2] Makefiles specify objects which depend on other
objects, and rules for generating the dependents. Please see the article
in the reference for details.</p>
</div>
<div class="section" id="references">
<h1>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h1>
<references/><p><a class="reference external" href="Category:Compiling">Category:Compiling</a> <a class="reference external" href="Category:Quick_Start">Category:Quick
Start</a></p>
<ol class="simple">
<li><p><a class="reference external" href="Quick_Start_Guide:Environment_Modules">Quick Start Guide:Environment
Modules</a></p></li>
<li><p><a class="reference external" href="Quick_Start_Guide:Make">Quick Start Guide:Make</a></p></li>
</ol>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">DEAC Cluster Wiki</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Adam Carlson, Cody Stevens, Sean Anderson.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.2.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/quick_start_guide/Compiling.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>