
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>PROFESS + QE &#8212; DEAC Cluster Wiki  documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="profess-qe">
<h1>PROFESS + QE<a class="headerlink" href="#profess-qe" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>This software has a very non-standard install process, and relies on out-of-date
libraries. Initial thoughts are that this will not be able to be a standardized
install for the cluster.</p>
<p>From what I can tell, there are three primary components:
* The patches that allow PROFESS3 to work with Quantum-Espresso
(<code class="docutils literal notranslate"><span class="pre">ProfAtQE2.0.1_20181012.tgz</span></code>), which is what you download from
<a class="reference external" href="http://www.qtp.ufl.edu/ofdft/research/computation.shtml">here</a>. We will
refer to this as ProfessAtQE for the remainder of this document.
* The PROFESS3 code, which can be obtained <a class="reference external" href="https://data.mendeley.com/datasets/jc57mcyv6t/1">after a few clicks
here</a>
(<code class="docutils literal notranslate"><span class="pre">aebn_v3_0.tar.gz</span></code>).
* The QE 5.2.1 code, which is not identical to the one that can be
downloaded from the QE website. I obtained this via the <a class="reference external" href="https://archive.org/web/">archive.org
Wayback Machine</a> (<code class="docutils literal notranslate"><span class="pre">espresso-5.2.1.tar.gz</span></code>).</p>
<p>The remainder of the pre-requisites are FFTW3, FFTW2, LAPACK, and an old version
of Libxc. I believe that some of these can be included via the Intel MKL.
Apparently, the intel MPI compilers act very differently when invoked as <code class="docutils literal notranslate"><span class="pre">mpicc</span></code>
and <code class="docutils literal notranslate"><span class="pre">mpif90</span></code> compared to <code class="docutils literal notranslate"><span class="pre">mpiicc</span></code> and <code class="docutils literal notranslate"><span class="pre">mpiifort</span></code>. The latter seem to have some
automatic connection with MKL, and thus, the various LAPACK, BLAS, FFTW3, and
FFTW2 libraries/interfaces that are available in it. It is worth exploring this
as an alternative to having to manually compile these libraries as detailed
below. This may not work for FFTW2, as the PROFESS+QE package includes a patch
for this library, and thus may not be compatible with the MKL version.</p>
<p>From talks with people smarter than me, it would seem like this is the perfect
candidate for containerization.</p>
</div>
<div class="section" id="work">
<h2>Work<a class="headerlink" href="#work" title="Permalink to this headline">¶</a></h2>
<div class="section" id="preamble">
<h3>Preamble<a class="headerlink" href="#preamble" title="Permalink to this headline">¶</a></h3>
<p>Set up your a directory for you to work in. Uncompress the three components:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nv">RESEARCH_PATH</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span><span class="s2">/scratch&quot;</span>
<span class="nb">cd</span> <span class="nv">$RESEARCH_PATH</span>/profess/
tar -xvf <span class="nv">$RESEARCH_PATH</span>/tarballs/profess/ProfAtQE2.0.1_20181012.tgz
tar -xvf <span class="nv">$RESEARCH_PATH</span>/tarballs/profess/aebn_v3_0.tar.gz
tar -xvf <span class="nv">$RESEARCH_PATH</span>/tarballs/profess/espresso-5.2.1.tar.gz
</pre></div>
</div>
<p>Patch the necessary files:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> <span class="nv">$RESEARCH_PATH</span>/profess/PROFESS3.0
patch -p1 &lt; <span class="nv">$RESEARCH_PATH</span>/profess/OFQE2.0.1/patches/PROFESS3.0-PROFESS3.0m5B.diff

<span class="nb">cd</span> <span class="nv">$RESEARCH_PATH</span>/profess/espresso-5.2.1
patch -p1 &lt; <span class="nv">$RESEARCH_PATH</span>/profess/OFQE2.0.1/patches/espresso-5.2.1-5.2.1m5.diff
</pre></div>
</div>
</div>
<div class="section" id="fftw-3-3-8">
<h3>FFTW 3.3.8<a class="headerlink" href="#fftw-3-3-8" title="Permalink to this headline">¶</a></h3>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>./configure --prefix<span class="o">=</span><span class="nv">$RESEARCH_PATH</span>/profess/fftw-3.3.8 <span class="nv">CC</span><span class="o">=</span>icc <span class="nv">F77</span><span class="o">=</span>ifort <span class="nv">MPICC</span><span class="o">=</span>mpiicc --enable-mpi
make -j16
make install
</pre></div>
</div>
</div>
<div class="section" id="fftw-2-1-5-profftw">
<h3>FFTW 2.1.5 (profftw)<a class="headerlink" href="#fftw-2-1-5-profftw" title="Permalink to this headline">¶</a></h3>
<p>For whatever reason, this does not like using <code class="docutils literal notranslate"><span class="pre">mpiicc</span></code> and <code class="docutils literal notranslate"><span class="pre">mpiifort</span></code>. Modify
makefile line 146 and remove ‘doc’. This version of FFTW uses Texinfo 4
which is obsolete.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>./configure --prefix<span class="o">=</span><span class="nv">$RESEARCH_PATH</span>/profess/fftw-2.1.5 <span class="nv">CC</span><span class="o">=</span>mpicc <span class="nv">F77</span><span class="o">=</span>mpif77 --enable-mpi
make clean
make
make install
</pre></div>
</div>
</div>
<div class="section" id="libxc-2-0-1">
<h3>Libxc 2.0.1<a class="headerlink" href="#libxc-2-0-1" title="Permalink to this headline">¶</a></h3>
<p>Unfortunately, PROFESS relies on an old version of Libxc (&lt; 2.1.0, circa
2013-2014), which I have not been able to compile correctly with any recent
compiler. I have tried compiling it on the cluster (lancaster and gemini) and
also on my desktop computer, using both gcc and Intel compilers. The regression
tests fail; I have manually compared the test results and they are indeed
different values. I assume it has to do with the modern C libraries prsent on
the OS. I have also tried on a CentOS 6 machine with old versions of GCC and the
Intel Compilers, and the tests continue to fail.</p>
<p>You may get an error about “Unclassifiable statement” from <code class="docutils literal notranslate"><span class="pre">src/libxc.f90</span></code>. Just
comment out all the text at the beginning with <code class="docutils literal notranslate"><span class="pre">!!</span></code>.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>./configure --prefix<span class="o">=</span><span class="nv">$RESEARCH_PATH</span>/profess/libxc-2.0.1 <span class="nv">CC</span><span class="o">=</span>mpicc <span class="nv">FC</span><span class="o">=</span>mpif90
make clean
make
make check
make install
</pre></div>
</div>
</div>
<div class="section" id="profess">
<h3>PROFESS<a class="headerlink" href="#profess" title="Permalink to this headline">¶</a></h3>
<p>See the attached modified makefiles, modify paths accordingly.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>make clean
make parallel
</pre></div>
</div>
</div>
<div class="section" id="qe-5-2-1">
<h3>QE 5.2.1<a class="headerlink" href="#qe-5-2-1" title="Permalink to this headline">¶</a></h3>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>./configure <span class="nv">FC</span><span class="o">=</span>ifort <span class="nv">CC</span><span class="o">=</span>mpiicc <span class="nv">F77</span><span class="o">=</span>ifort <span class="nv">MPIF90</span><span class="o">=</span>mpiifort
</pre></div>
</div>
</div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">DEAC Cluster Wiki</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Adam Carlson, Cody Stevens, Sean Anderson.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.2.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/software/PROFESS.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>