
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>CUDA &#8212; DEAC Cluster Wiki  documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="cuda">
<h1>CUDA<a class="headerlink" href="#cuda" title="Permalink to this headline">¶</a></h1>
<p>https://nvidia.com/en-us/</p>
<p>https://docs.nvidia.com/cuda/cuda-installation-guide-linux/index.html</p>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>CUDA is a parallel computing platform and programming model developed by NVIDIA
for general computing on graphical processing units (GPUs). With CUDA,
developers are able to dramatically speed up computing applications by
harnessing the power of GPUs.</p>
</div>
<div class="section" id="installed-versions">
<h2>Installed Versions<a class="headerlink" href="#installed-versions" title="Permalink to this headline">¶</a></h2>
<p>Driver Version: 440.64.00</p>
<p>CUDA Version: 10.2</p>
<div class="section" id="prerequisites">
<h3>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h3>
<p>bash, gcc, gcc-c++</p>
</div>
<div class="section" id="installation">
<h3>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h3>
<p>All NVIDIA related software is installed via rpm. There are five RPMs that need
to be installed for CUDA based programming. These RPMs install the CUDA repo,
device drivers for the P100 and V100 Telsa GPU models, and the cuDNN deep
learning module.</p>
<p>Downloaded .rpm files are stored in /deac/opt/src/rhel7/NVIDIA/drivers</p>
<p>Install RPM containing repo information to download CUDA 10.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">/</span><span class="n">deac</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">rhel7</span><span class="o">/</span><span class="n">NVIDIA</span><span class="o">/</span><span class="n">drivers</span>
<span class="n">rpm</span> <span class="o">-</span><span class="n">i</span> <span class="n">cuda</span><span class="o">-</span><span class="n">repo</span><span class="o">-</span><span class="n">rhel7</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">2</span><span class="o">-</span><span class="n">local</span><span class="o">-</span><span class="mf">10.2</span><span class="o">.</span><span class="mi">89</span><span class="o">-</span><span class="mf">440.33</span><span class="o">.</span><span class="mi">01</span><span class="o">-</span><span class="mf">1.0</span><span class="o">-</span><span class="mf">1.</span><span class="n">x86_64</span><span class="o">.</span><span class="n">rpm</span>
</pre></div>
</div>
<p>Install RPM containing the most up to date nvidia driver 440.64 versus version
440.33 in the above RPM</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rpm</span> <span class="o">-</span><span class="n">i</span> <span class="n">nvidia</span><span class="o">-</span><span class="n">driver</span><span class="o">-</span><span class="n">local</span><span class="o">-</span><span class="n">repo</span><span class="o">-</span><span class="n">rhel7</span><span class="o">-</span><span class="mf">440.64</span><span class="o">.</span><span class="mi">00</span><span class="o">-</span><span class="mf">1.0</span><span class="o">-</span><span class="mf">1.</span><span class="n">x86_64</span><span class="o">.</span><span class="n">rpm</span>
</pre></div>
</div>
<p>Install repo packages via yum</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">yum</span> <span class="n">clean</span> <span class="nb">all</span>

<span class="n">yum</span> <span class="o">-</span><span class="n">y</span> <span class="n">install</span> <span class="n">nvidia</span><span class="o">-</span><span class="n">driver</span><span class="o">-</span><span class="n">latest</span><span class="o">-</span><span class="n">dkms</span> <span class="n">cuda</span>
<span class="n">yum</span> <span class="o">-</span><span class="n">y</span> <span class="n">install</span> <span class="n">cuda</span><span class="o">-</span><span class="n">drivers</span>
</pre></div>
</div>
<p>CUDA is installed locally under /usr/local/cuda</p>
<p>After installing the device drivers, reboot</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">reboot</span>
</pre></div>
</div>
<p>Verify that the NVIDIA drivers are loaded correctly</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nvidia</span><span class="o">-</span><span class="n">smi</span>
</pre></div>
</div>
<p>Install cuDNN RPMs</p>
<p>https://docs.nvidia.com/deeplearning/sdk/cudnn-install/index.html</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">/</span><span class="n">deac</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">rhel7</span><span class="o">/</span><span class="n">NVIDIA</span><span class="o">/</span><span class="n">drivers</span>
<span class="n">rpm</span> <span class="o">-</span><span class="n">i</span> <span class="n">libcudnn7</span><span class="o">-</span><span class="mf">7.6</span><span class="o">.</span><span class="mf">5.33</span><span class="o">-</span><span class="mf">1.</span><span class="n">cuda10</span><span class="o">.</span><span class="mf">2.</span><span class="n">x86_64</span><span class="o">.</span><span class="n">rpm</span> <span class="n">libcudnn7</span><span class="o">-</span><span class="n">devel</span><span class="o">-</span><span class="mf">7.6</span><span class="o">.</span><span class="mf">5.33</span><span class="o">-</span><span class="mf">1.</span><span class="n">cuda10</span><span class="o">.</span><span class="mf">2.</span><span class="n">x86_64</span><span class="o">.</span><span class="n">rpm</span> <span class="n">libcudnn7</span><span class="o">-</span><span class="n">doc</span><span class="o">-</span><span class="mf">7.6</span><span class="o">.</span><span class="mf">5.33</span><span class="o">-</span><span class="mf">1.</span><span class="n">cuda10</span><span class="o">.</span><span class="mf">2.</span><span class="n">x86_64</span><span class="o">.</span><span class="n">rpm</span>
</pre></div>
</div>
</div>
<div class="section" id="post-installation">
<h3>Post Installation<a class="headerlink" href="#post-installation" title="Permalink to this headline">¶</a></h3>
<div class="section" id="configure-nvidia-persistenced">
<h4>Configure nvidia-persistenced<a class="headerlink" href="#configure-nvidia-persistenced" title="Permalink to this headline">¶</a></h4>
<p>The daemon nvidia-persistenced is used to the ensure the NVIDIA drivers are
loaded across multiple reboots. In the event that the NVIDIA driver fails to
load you will need to uninstall and remove and recomplete the above
installation steps.</p>
<p>init.d script /etc/init.d/</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#!/bin/sh
#
# nvidia-persistenced:       Starts the Nvidia persistence daemon
#
# chkconfig: 345 99 01
# description: Nvidia perstence daemon keeps nvidia devices present
#
# processname: nvidia-persistenced
# pidfile: /var/run/nvidia-persistenced/lnvidia-persistenced.pid
#

#  load sysconfig configuration file
if [ ! -x /usr/bin/nvidia-smi ]; then
     echo &quot;$0:  Could not find nvidia-smi installation!&quot;
     exit 1
fi

#:x:487:486:NVIDIA persistent software state:/var/run/nvidia-persistenced:/sbin/nologin
NVIDIAPER_USER=nvidia-persistenced
NVIDIAPER_COMMAND=nvidia-persistenced
NVIDIAPER_BINARY=/usr/bin/nvidia-persistenced
NVIDIAPER_LOG=/var/log/nvidia-persistenced.log

###  Sanity checks
if [ ! -f ${NVIDIAPER_BINARY} ]; then
     echo &quot;$0:  Could not find nvidia-persistenced daemon!&quot;
     exit 1
fi

if ! id $NVIDIAPER_USER &gt;&amp; /dev/null; then
     echo &quot;$0:  User $NVIDIAPER_USER not found!&quot;
     exit 1
fi

###  Load Red Hat init functions
. /etc/rc.d/init.d/functions

RETVAL=0

start() {

     touch ${NVIDIAPER_LOG}
     chown ${NVIDIAPER_USER}:${NVIDIAPER_USER} ${NVIDIAPER_LOG}
     chmod 640 ${NVIDIAPER_LOG}

     echo -n $&quot;Starting Nvidia Persistence Daemon: &quot;
     su - $NVIDIAPER_USER -c &quot;${NVIDIAPER_BINARY} --user=${NVIDIAPER_USER} --group=${NVIDIAPER_USER} -V&quot;
     RETVAL=$?
     [ $RETVAL -eq 0 ] &amp;&amp; success $&quot;$base startup&quot; || failure $&quot;$base startup&quot;
     echo
     [ $RETVAL -eq 0 ] &amp;&amp; touch /var/lock/subsys/nvidia-persistenced
}

stop() {
     echo -n $&quot;Shutting down Nvidia Persistence Daemon: &quot;
     killproc ${NVIDIAPER_COMMAND}
     RETVAL=$?
     echo
     if [ $RETVAL -eq 0 ]; then
          rm -f /var/lock/subsys/nvidia-persistenced
     fi
}

case &quot;$1&quot; in
     start)
          start
          ;;
     stop)
          stop
          ;;
     status)
          status ${NVIDIAPER_COMMAND}
          RETVAL=$?
          ;;
     restart)
          stop
          start
          ;;
     condrestart)
          if [ -f /var/lock/subsys/nvidia-persistenced ]; then
               stop
               start
          fi
          ;;
     *)
          echo $&quot;Usage: $0 {start|stop|status|restart|condrestart}&quot;
          ;;
esac
exit $RETVAL
</pre></div>
</div>
<p>Enable nvidia-persistenced service</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">systemctl</span> <span class="n">enable</span> <span class="n">nvidia</span><span class="o">-</span><span class="n">persistenced</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="module-file">
<h3>Module file<a class="headerlink" href="#module-file" title="Permalink to this headline">¶</a></h3>
<p>/etc/modulefiles/rhel7/gpu/cuda/10.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#%Module########################################################################
##
## cuda/10.2 modulefile
##

# for Tcl script use only

# Officially is 10.2
set      version  10.2

proc ModulesHelp { } {
    global version

    puts stderr &quot;    This module sets up the environment to use CUDA $version&quot;
}

module-whatis	&quot;Sets up the environment to use CUDA $version&quot;


set CUDADIR /usr/local/cuda-$version

prepend-path PATH  $CUDADIR/bin
prepend-path LD_LIBRARY_PATH $CUDADIR/lib64
</pre></div>
</div>
</div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">DEAC Cluster Wiki</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Adam Carlson, Cody Stevens, Sean Anderson.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.2.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/software/CUDA.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>